{
  "Version": "2019-10-30",
  "StartAction": "invoke-greeting",
  "Actions": [
    {
      "Identifier": "invoke-greeting",
      "Type": "InvokeLambdaFunction",
      "Parameters": {
        "LambdaFunctionARN": "arn:aws:lambda:us-east-1:593804350786:function:CensusStrandsAgent",
        "InvocationTimeLimitSeconds": "8",
        "LambdaInvocationAttributes": {
          "inputText": "__greeting__"
        }
      },
      "Transitions": {
        "NextAction": "speak-response",
        "Errors": [{"NextAction": "disconnect", "ErrorType": "NoMatchingError"}],
        "Conditions": []
      }
    },
    {
      "Identifier": "speak-response",
      "Type": "MessageParticipant",
      "Parameters": {"Text": "$.External.response"},
      "Transitions": {
        "NextAction": "wait-for-input",
        "Errors": [{"NextAction": "disconnect", "ErrorType": "NoMatchingError"}],
        "Conditions": []
      }
    },
    {
      "Identifier": "wait-for-input",
      "Type": "GetParticipantInput",
      "Parameters": {
        "Text": "Please type your response.",
        "StoreInput": "False",
        "InputTimeLimitSeconds": "120"
      },
      "Transitions": {
        "NextAction": "invoke-turn",
        "Errors": [
          {"NextAction": "disconnect", "ErrorType": "InputTimeLimitExceeded"},
          {"NextAction": "invoke-turn", "ErrorType": "NoMatchingCondition"},
          {"NextAction": "invoke-turn", "ErrorType": "NoMatchingError"}
        ],
        "Conditions": []
      }
    },
    {
      "Identifier": "invoke-turn",
      "Type": "InvokeLambdaFunction",
      "Parameters": {
        "LambdaFunctionARN": "arn:aws:lambda:us-east-1:593804350786:function:CensusStrandsAgent",
        "InvocationTimeLimitSeconds": "8",
        "LambdaInvocationAttributes": {
          "inputText": "$.StoredCustomerInput"
        }
      },
      "Transitions": {
        "NextAction": "speak-response",
        "Errors": [{"NextAction": "escalate-message", "ErrorType": "NoMatchingError"}],
        "Conditions": []
      }
    },
    {
      "Identifier": "escalate-message",
      "Type": "MessageParticipant",
      "Parameters": {"Text": "Of course! Please hold while I connect you with a live agent."},
      "Transitions": {
        "NextAction": "set-queue",
        "Errors": [{"NextAction": "set-queue", "ErrorType": "NoMatchingError"}],
        "Conditions": []
      }
    },
    {
      "Identifier": "set-queue",
      "Type": "UpdateContactTargetQueue",
      "Parameters": {"QueueId": "arn:aws:connect:us-east-1:593804350786:instance/1d3555df-0f7a-4c78-9177-d42253597de2/queue/e782af1e-ea59-4428-bb30-51ccb607f49b"},
      "Transitions": {
        "NextAction": "transfer-to-agent",
        "Errors": [{"NextAction": "disconnect", "ErrorType": "NoMatchingError"}],
        "Conditions": []
      }
    },
    {
      "Identifier": "transfer-to-agent",
      "Type": "TransferContactToQueue",
      "Parameters": {},
      "Transitions": {
        "NextAction": "disconnect",
        "Errors": [
          {"NextAction": "disconnect", "ErrorType": "NoMatchingError"},
          {"NextAction": "disconnect", "ErrorType": "QueueAtCapacity"}
        ],
        "Conditions": []
      }
    },
    {
      "Identifier": "disconnect",
      "Type": "DisconnectParticipant",
      "Parameters": {},
      "Transitions": {}
    }
  ]
}
